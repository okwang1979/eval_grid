!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom"),require("nc-report")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom","nc-report"],t):"object"==typeof exports?exports["ct/ct/report/salereportsubscribe/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom"),require("nc-report")):e["ct/ct/report/salereportsubscribe/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM,e["nc-report"])}(window,function(e,t,r,n){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../../../../",r(r.s=932)}({0:function(t,r){t.exports=e},10:function(e,r){e.exports=t},12:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRefShowDisabledData=t.setPsndocShowLeavePower=t.vbatchcodeHelper=t.getUrlParam=t.crossRuleUtils=t.marAsstUtils=t.transtypeUtils=t.dateFormat=t.deepClone=void 0;var n=f(r(27)),o=f(r(19)),a=f(r(30)),i=f(r(34)),u=r(35),c=f(r(36)),s=r(0),l=r(21);function f(e){return e&&e.__esModule?e:{default:e}}t.deepClone=s.deepClone,t.dateFormat=n.default,t.transtypeUtils=o.default,t.marAsstUtils=a.default,t.crossRuleUtils=i.default,t.getUrlParam=u.getUrlParam,t.vbatchcodeHelper=c.default,t.setPsndocShowLeavePower=l.setPsndocShowLeavePower,t.setRefShowDisabledData=l.setRefShowDisabledData},19:function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){return(this.transtypeData||{}).pk_transtype}function a(){return(this.transtypeData||{}).transtype_name}Object.defineProperty(t,"__esModule",{value:!0}),t.default={init:function(e){e&&e.paramMap&&e.paramMap.transtype&&(this.transtypeData={transtype:e.paramMap.transtype,transtype_name:e.paramMap.transtype_name,pk_transtype:e.paramMap.pk_transtype})},getTranstypeID:o,getTranstypeCode:function(){return(this.transtypeData||{}).transtype},getTranstypeName:a,beforeEdit:function(e,t,r){return e!=t&&e!=r||!this.transtypeData||!this.transtypeData.transtype},setValue:function(e,t,r){var o;this.transtypeData&&this.props.form.setFormItemsValue(e,(n(o={},t,{value:this.transtypeData.pk_transtype,display:this.transtypeData.transtype_name}),n(o,r,{value:this.transtypeData.transtype,display:this.transtypeData.transtype}),o))},beforeSearch:function(e,t,r){if(e&&this.transtypeData&&this.transtypeData.pk_transtype){e.querycondition||(e.querycondition={}),e.querycondition.conditions||(e.querycondition.conditions=[]),e.querycondition.logic||(e.querycondition.logic="and");var n={field:t,datatype:"204",oprtype:"=",value:{firstvalue:this.transtypeData.pk_transtype}};e.querycondition.conditions.push(n)}return e},initQuery:function(e,t,r,n){var o=t[r].items.find(function(e){return e.attrcode==n});o&&this.transtypeData&&(o.disabled=!0,o.isfixedcondition=!0,o.visible=!0)},setQueryDefaultValue:function(e,t,r){this.transtypeData&&e.search.setSearchValByField(t,r,{display:a.call(this),value:o.call(this)})}}},21:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPsndocShowLeavePower=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.isShowDimission=t},t.setRefShowDisabledData=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.isShowDisabledData=t,e.unitPropsExtend={isShowDisabledData:t,isHasDisabledData:t}}},27:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e}}},30:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=r(0);r(31);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default={resetItem:function(e,t,r,a,u,c){var s=e.meta.getMeta()[a].items.find(function(e){return e.attrcode==u});if("refer"==s.itemtype){var l=s.queryCondition;"function"!=typeof l||s.filterCon||(s.filterCon=l),e.cardTable.setQueryCondition(a,i({},u,function(e){"function"==typeof l?l=o({},l(e)):"object"===(void 0===l?"undefined":n(l))&&(l=o({},s.filterCon(e)));var f="TreeRefActionExt";return"grid"!=e.refType&&"gridTree"!=e.refType||(f="GridRefActionExt"),l.appcode=t,l.pagecode=r,l.areacode=a,l.data=JSON.stringify(i({},a,{areacode:a,rows:[c]})),l.defineField=u,l[f]="nccloud.web.scmpub.pub.marasst.MarAsstDefaultRef",l.UsualGridRefActionExt="nccloud.web.scmpub.pub.marasst.MarAsstDefaultRef",l}))}},afterEdit:function(e,t,r,n,o,i,u,c){var s={appcode:t,pagecode:r,areacode:n,controlField:o,controlValue:(u.values[o]||{}).value,materialvid:(u.values[i]||{}).value};(0,a.ajax)({url:"/nccloud/scmpub/pub/marasstAfterEdit.do",data:s,async:!1,mode:"normal",success:function(t){if(console.log(t,"hj"),t.data&&t.data.data)for(var r in t.data.data){var o=t.data.data[r];if(o&&0!=o.length){var a=(u.values[r]||{}).value;o.includes(a)||e.cardTable.setValByKeyAndIndex(n,c,r,{value:null,display:null,scale:-1})}else e.cardTable.setValByKeyAndIndex(n,c,r,{value:null,display:null,scale:-1})}}})},resetGridItem:function(e,t,r,a,u,c){var s=e.meta.getMeta()[a].items.find(function(e){return e.attrcode==u});if("refer"==s.itemtype){var l=s.queryCondition;s.queryCondition=function(e){l=o({},"function"==typeof l?l(e):"object"===(void 0===l?"undefined":n(l))?l:{});var s="TreeRefActionExt";return"grid"!=e.refType&&"gridTree"!=e.refType||(s="GridRefActionExt"),l.appcode=t,l.pagecode=r,l.areacode=a,l.data=JSON.stringify(i({},a,{areacode:a,rows:[c]})),l.defineField=u,l[s]="nccloud.web.scmpub.pub.marasst.MarAsstDefaultRef",l.UsualGridRefActionExt="nccloud.web.scmpub.pub.marasst.MarAsstDefaultRef",l}}},resetViewItem:function(e,t,r,a,u,c){var s=e.meta.getMeta()[a].items.find(function(e){return e.attrcode==u});if("refer"==s.itemtype){var l=s.queryCondition;"function"!=typeof l||s.filterCon||(s.filterCon=l),e.cardTable.setQueryCondition(a,i({},u,function(e){"function"==typeof l?l=o({},l(e)):"object"===(void 0===l?"undefined":n(l))&&(l=o({},s.filterCon(e)));var f="TreeRefActionExt";return"grid"!=e.refType&&"gridTree"!=e.refType||(f="GridRefActionExt"),l.appcode=t,l.pagecode=r,l.areacode=a,l.data=JSON.stringify(i({},a,{areacode:a,rows:[c]})),l.defineField=u,l[f]="nccloud.web.scmpub.pub.marasst.ViewMarAsstDefaultRef",l.UsualGridRefActionExt="nccloud.web.scmpub.pub.marasst.ViewMarAsstDefaultRef",l}))}}}},31:function(e,t,r){"use strict";t.decode=t.parse=r(32),t.encode=t.stringify=r(33)},32:function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,a){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var u=/\+/g;e=e.split(t);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var s=e.length;c>0&&s>c&&(s=c);for(var l=0;l<s;++l){var f,d,p,y,b=e[l].replace(u,"%20"),v=b.indexOf(r);v>=0?(f=b.substr(0,v),d=b.substr(v+1)):(f=b,d=""),p=decodeURIComponent(f),y=decodeURIComponent(d),n(i,p)?o(i[p])?i[p].push(y):i[p]=[i[p],y]:i[p]=y}return i};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},33:function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,u){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?a(i(e),function(i){var u=encodeURIComponent(n(i))+r;return o(e[i])?a(e[i],function(e){return u+encodeURIComponent(n(e))}).join(t):u+encodeURIComponent(n(e[i]))}).join(t):u?encodeURIComponent(n(u))+r+encodeURIComponent(n(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},34:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=r(12);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if(e&&e[t]&&e[t].rows&&e[t].rows[0]){var r=(0,a.deepClone)(e),n=r[t].rows[0].values,o={},i=void 0;for(i in n)n[i]&&n[i].value&&(o[i]=n[i]);return r[t].rows=[{values:o}],JSON.stringify(r)}}t.default={beforeEdit:function(e){var t=e.props,r=e.appcode,a=e.pagecode,c=e.headarea,s=e.bodyarea,l=e.key,f=e.isHead,d=e.record,p=e.billtype,y=e.pk_org_field,b=e.transtypeid_field,v=t.meta.getMeta(),m=void 0;if(f){var h=t.cardTable.getCheckedRows(s);!h&&h.length>0&&(d=h[0]),m=v[c].items.find(function(e){return e.attrcode==l})}else m=v[s].items.find(function(e){return e.attrcode==l});var g={};g.pk_org=(t.form.getFormItemsValue(c,y)||{}).value,g.transtype=(t.form.getFormItemsValue(c,b)||{}).value,g.key=l,g.billtype=p,g.currarea=f?c:s,g.appcode=r,g.pagecode=a,g.headarea=c,g.bodyarea=s,g.headdata=u(i({},c,t.form.getAllFormValue(c)),c),g.bodydata=u(i({},s,{rows:[d]}),s),m._queryCondition=m._queryCondition||m.queryCondition;var _=f?m._queryCondition:m.queryCondition;_&&_.crossRuleParams||(f?(m&&"refer"==m.itemtype&&(m.queryCondition=function(e){if(_=o({},"function"==typeof _?_(e):"object"===(void 0===_?"undefined":n(_))?_:{}),!e)return _;var t="TreeRefActionExt";return"grid"!=e.refType&&"gridTree"!=e.refType||(t="GridRefActionExt"),(!_[t]||_[t].indexOf("nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder")<0)&&(_[t]=_[t]?_[t]+",nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder":"nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder"),(!_.UsualGridRefActionExt||_.UsualGridRefActionExt.indexOf("nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder")<0)&&(_.UsualGridRefActionExt=_.UsualGridRefActionExt?_.UsualGridRefActionExt+",nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder":"nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder"),_.crossRuleParams=JSON.stringify(g),_}),t.meta.setMeta(v)):t.cardTable.setQueryCondition(s,i({},l,function(e){if(_=o({},"function"==typeof _?_(e):"object"===(void 0===_?"undefined":n(_))?_:{}),!e)return _;var t="TreeRefActionExt";return"grid"!=e.refType&&"gridTree"!=e.refType||(t="GridRefActionExt"),(!_[t]||_[t].indexOf("nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder")<0)&&(_[t]=_[t]?_[t]+",nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder":"nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder"),(!_.UsualGridRefActionExt||_.UsualGridRefActionExt.indexOf("nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder")<0)&&(_.UsualGridRefActionExt=_.UsualGridRefActionExt?_.UsualGridRefActionExt+",nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder":"nccloud.web.scmpub.pub.crossrule.CrossRuleSqlBuilder"),_.crossRuleParams=JSON.stringify(g),_})))}}},35:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlParam=function(e){var t=decodeURIComponent(window.parent.location.href).split("?");if(t&&t[1]){var r=t[1].split("&");if(r&&r instanceof Array){var n={};return r.forEach(function(e){var t=e.split("=")[0],r=e.split("=")[1];n[t]=r}),n[e]}}}},36:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default={onBlur:function(e,t,r,a,i,u){var c=this;if(u){var s={onhandDimAppcode:e.appcode,onhandDimPagecode:e.pagecode,onhandDimVOGrid:{head:{areaType:"table",rows:[e.headRows.rows[0]]},pageid:e.pagecode},appcode:t.appcode,pagecode:t.pagecode,bodyarea:t.bodyarea,currGrid:o({},t.bodyarea,{rows:[t.record]}),batchcode:u,canInsert:a};(0,n.ajax)({url:r,data:s,mode:"normal",success:function(e){i&&i.call(c,t.bodyarea,t.index,e.data)}})}}}},58:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t,r){"object"==(void 0===t?"undefined":n(t))&&t.constructor==Array&&e.map(function(e){t.includes(e.attrcode)&&(e.isShowUnit=r)}),"string"==typeof t&&t.constructor==String&&e.map(function(e){t==e.attrcode&&(e.isShowUnit=r)})}t.default=function(e,t,r,o){var a=e.meta.getMeta(),i=a[r].items,u=0;if("object"==(void 0===o?"undefined":n(o))&&o.constructor==Array)if(t&&(1==t.length||t.refpk))for(var c=0;c<i.length;c++)for(var s=0,l=o.length;s<l;s++){var f=i[c];if(f.attrcode==o[s]){if(f.isShowUnit&&0==f.isShowUnit)continue;if(u++,f.isShowUnit=!1,u==l)break}}else for(var d=0;d<i.length;d++)for(var p=0,y=o.length;p<y;p++){var b=i[d];if(b.attrcode==o[p]){if(b.isShowUnit)continue;if(u++,b.isShowUnit=!0,u==y)break}}else if("string"==typeof o&&o.constructor==String)if(t&&(1==t.length||t.refpk))for(var v=0;v<i.length;v++){var m=i[v];m.attrcode==o&&(m.isShowUnit=!1)}else for(var h=0;h<i.length;h++){var g=i[h];g.attrcode==o&&(g.isShowUnit=!0)}e.meta.setMeta(a)},t.multiCorpInit=function(e,t){if(!e)return;!function(e,t){e.map(function(e){e.isShowUnit=!1}),function(e,t){o(e,t,!0)}(e,t)}(e,t)}},61:function(e,t){e.exports=r},932:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=f(o),i=f(r(61)),u=r(97),c=r(58),s=f(c),l=r(12);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),n(t,[{key:"componentWillMount",value:function(){}},{key:"disposeSearch",value:function(e,t){var r=e.light_report.items;return(0,c.multiCorpInit)(r,["pk_customer","depid","personnelid","pk_ct_sale_b.pk_marbasclass","pk_ct_sale_b.pk_srcmaterial","ctrantypeid"].concat(p("vdef",20)).concat(p("pk_ct_sale_b.vfree",10)).concat(p("pk_ct_sale_b.vbdef",20))),r.forEach(function(e){"pk_org"==e.attrcode&&(e.queryCondition=function(){return{TreeRefActionExt:"nccloud.web.scmpub.ref.AppPermissionOrgRefFilter"}}),("pk_customer"==e.attrcode||"pk_ct_sale_b.pk_marbasclass"==e.attrcode||"pk_ct_sale_b.pk_srcmaterial"==e.attrcode||"depid"==e.attrcode||"personnelid"==e.attrcode||p("vdef",20).indexOf(e.attrcode)>=0||p("pk_ct_sale_b.vfree",10).indexOf(e.attrcode)>=0||p("pk_ct_sale_b.vbdef",20).indexOf(e.attrcode)>=0)&&(e.isShowUnit=!0,e.queryCondition=function(){var r=t.search.getSearchValByField("light_report","pk_org");return r=r&&r.value&&r.value.firstvalue?r.value.firstvalue:"","depid"==e.attrcode||"personnelid"==e.attrcode?{isDataPowerEnable:!1,pk_org:r,busifuncode:"sa"}:{isDataPowerEnable:!1,pk_org:r}}),"ctrantypeid"==e.attrcode&&(e.queryCondition=function(){return{parentbilltype:"Z3",istransaction:"Y"}}),(0,l.setPsndocShowLeavePower)(e),(0,l.setRefShowDisabledData)(e)}),e}},{key:"setDefaultVal",value:function(e,t){}},{key:"setConnectionSearch",value:function(e,t,r,n,o,a,i){}},{key:"expandSearchVal",value:function(e,t){return result}},{key:"onAfterEvent",value:function(e,t,r,n){"pk_org"==r&&(0,s.default)(e,n,t,["pk_customer","depid","personnelid","pk_ct_sale_b.pk_marbasclass","pk_ct_sale_b.pk_srcmaterial","ctrantypeid"].concat(p("vdef",20)).concat(p("pk_ct_sale_b.vfree",10)).concat(p("pk_ct_sale_b.vbdef",20)))}},{key:"renderCompleteEvent",value:function(e,t){var r=e.search.getSearchValByField(t,"pk_org");if(r&&r.value&&r.value.firstvalue){var n=r.value.firstvalue.split(",");n=n.map(function(e){return{refpk:e}}),this.onAfterEvent(e,t,"pk_org",n)}}},{key:"render",value:function(){return a.default.createElement("div",{className:"table"},a.default.createElement(u.SimpleReport,{showAdvBtn:!0,setDefaultVal:this.setDefaultVal.bind(this),disposeSearch:this.disposeSearch.bind(this),onAfterEvent:this.onAfterEvent,renderCompleteEvent:this.renderCompleteEvent.bind(this)}))}}]),t}();function p(e,t){for(var r=[],n=1;n<=t;n++)r.push(e+n);return r}t.default=d,i.default.render(a.default.createElement(d,null),document.querySelector("#app"))},97:function(e,t){e.exports=n}})});
//# sourceMappingURL=index.3923348e.js.map