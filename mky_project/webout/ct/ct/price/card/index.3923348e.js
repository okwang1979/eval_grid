!function(e,a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("nc-lightapp-front"),require("react")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react"],a):"object"==typeof exports?exports["ct/ct/price/card/index"]=a(require("nc-lightapp-front"),require("react")):e["ct/ct/price/card/index"]=a(e["nc-lightapp-front"],e.React)}(window,function(e,a){return function(e){var a={};function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)t.d(r,n,function(a){return e[a]}.bind(null,n));return r},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="../../../../",t(t.s=341)}({0:function(a,t){a.exports=e},10:function(e,t){e.exports=a},104:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e,a){console.log(111,a);var t=a.valueChange;if(a.item.attrcode==e){if(0==t.length)return!0;if(/^-?[0-9]*(\.\d*)?$|^-?d^(\.\d*)?$/.test(t)){if(-1!=t.indexOf("-")&&"0"==t.substr(1,1)){if("."==t.substr(1))return!1;if(t.length>2&&"."!=t.substr(2,1))return!1}else if("0"==t.substr(0,1)){if("."==t.substr(0))return!1;if(t.length>1&&"."!=t.substr(1,1))return!1}return!0}return!1}return!0}},138:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,n,o=t(0);a.default=(r=regeneratorRuntime.mark(function e(a,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){(0,o.ajax)({url:a,data:t,success:function(a){if(a.data){var t=a.data.isedit;t?e(t):a.data.message&&(0,o.toast)({color:"warning",content:a.data.message}),e(!1)}},error:function(a){(0,o.toast)({color:"warning",content:a.message}),e(!1)}})}));case 1:case"end":return e.stop()}},e,this)}),n=function(){var e=r.apply(this,arguments);return new Promise(function(a,t){return function r(n,o){try{var i=e[n](o),c=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});a(c)}("next")})},function(e,a){return n.apply(this,arguments)})},168:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.fillCurrentBill=function(e,a,t){var l=this;t||(t=c(r.PriceCache.PriceCacheKey),(0,i.changeUrlParam)(e,{id:t}));if(!t)return void("function"==typeof a&&a&&a());var d={pks:[t],pageId:r.PAGECODE.card};(0,n.ajax)({url:r.ACTION_URL.cardSetUp,data:d,success:function(t){if(t.success){if(t.data){var n=t.data;if(n.head&&e.form.setAllFormValue(function(e,a,t){a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t;return e}({},r.AREA.card_head,n.head[r.AREA.card_head])),n.body&&n.body[r.AREA.card_body]){var i=n.body[r.AREA.card_body];e.cardTable.setTableData(r.AREA.card_body,i,null,!0,!0)}var c=n.head[r.AREA.card_head].rows[0].values.pk_ct_price.value,d=n.head[r.AREA.card_head].rows[0].values.pk_pricetemplet.value;o.handleDynamicColumn.call(l,e,c,d,r.AREA.card_body)}else e.button.setButtonVisible(r.BUTTON_CARD_EDIT,!1),e.button.setButtonVisible(r.BUTTON_CARD.Add,!0),e.button.setButtonVisible(r.BUTTON_CARD.Delete,!1);"function"==typeof a&&a&&a()}}})};var r=t(8),n=t(0),o=t(59),i=t(7);var c=n.cardCache.getCurrentLastId},169:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.queryPriceData=void 0;a.queryPriceData=(r=regeneratorRuntime.mark(function e(a,t,r,n,f,p,h){var A,b,_=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(A=o.ACTION_URL.cardSetUp,b={pks:[t],pageId:o.PAGECODE.card},!f){e.next=8;break}A=o.ACTION_URL.queryByPu,b={pk_org:r,pk_ct_pu:n,pk_ct_price:f,ctrantypeid:p,nqtorigtaxprice:h,pageId:o.PAGECODE.card},this.isFromPurdaily=!0,e.next=13;break;case 8:if(t){e.next=13;break}return a.form.EmptyAllFormValue(o.AREA.card_head),a.cardTable.setTableData(o.AREA.card_body,{rows:[]}),d.togglePageStatus.call(this,a,o.UISTATUS.browse),e.abrupt("return");case 13:return e.abrupt("return",new Promise(function(e,r){(0,i.ajax)({url:A,data:b,success:function(n){if(n.success){var i=n.data;if(a.form.EmptyAllFormValue(o.AREA.card_head),a.cardTable.setTableData(o.AREA.card_body,{rows:[]}),!i)return void d.togglePageStatus.call(_,a,o.UISTATUS.browse);if(i.head&&a.form.setAllFormValue(s({},o.AREA.card_head,i.head[o.AREA.card_head])),i.body&&i.body[o.AREA.card_body]){var f=i.body[o.AREA.card_body];a.cardTable.setTableData(o.AREA.card_body,f,null,!0,!0)}var p=i.head[o.AREA.card_head].rows[0].values,h=p.pk_pricetemplet.value,A=p.pk_ct_price.value;c.handleDynamicColumn.call(_,a,A,h,o.AREA.card_body),_.bvalidateflag=a.form.getFormItemsValue(o.AREA.card_head,o.FIELDS.bvalidateflag).value,_.iversion=a.form.getFormItemsValue(o.AREA.card_head,o.FIELDS.iversion).value,(0,l.updateCacheData)(_.props,o.FIELDS.pk_ct_price,t,i,o.AREA.card_head,o.PriceCache.PriceCacheKey),u.call(_,a,i),e(!0)}else r(!1)}})}));case 14:case"end":return e.stop()}},e,this)}),n=function(){var e=r.apply(this,arguments);return new Promise(function(a,t){return function r(n,o){try{var i=e[n](o),c=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});a(c)}("next")})},function(e,a,t,r,o,i,c){return n.apply(this,arguments)});var r,n,o=t(8),i=t(0),c=t(59),l=t(7),d=t(45);function s(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function u(e,a){if(a.userjson){var t=JSON.parse(a.userjson);t.isFromPurdaily?e.cardTable.setColVisibleByKey(o.AREA.card_body,{showKeys:[o.FIELDS.totalprice]}):e.cardTable.setColVisibleByKey(o.AREA.card_body,{hideKeys:[o.FIELDS.totalprice]}),t.isMultiPriceType?e.cardTable.setColVisibleByKey(o.AREA.card_body,{showKeys:[o.FIELDS.baseprice]}):e.cardTable.setColVisibleByKey(o.AREA.card_body,{hideKeys:[o.FIELDS.baseprice]}),e.cardTable.setColEditableByKey(o.AREA.card_body,[o.FIELDS.totalprice,o.FIELDS.baseprice],!0)}}},170:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.History=void 0;var r,n=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),o=t(10),i=(r=o)&&r.__esModule?r:{default:r},c=t(8),l=t(0),d=t(171),s=t(59);var u=function(e){function a(e){return function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return function(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,o.Component),n(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"setTableBodyData",value:function(e,a){var t=this;if(!a){var r={pks:[e.pk_ct_price.value],pageId:c.PAGECODE.history,areacode:c.AREA.history_body};(0,l.ajax)({url:c.ACTION_URL.queryHistoryBody,data:r,success:function(a){var r=a.success,n=a.data;r?(t.props.insertTable.setChildTableData(c.AREA.history_head,e,n[c.AREA.history_body],c.FIELDS.pk_ct_price_b),s.handleDynamicColumn.call(t,t.props,e.pk_ct_price.value,e.pk_pricetemplet.value,c.AREA.history_body)):t.props.insertTable.setChildTableData(c.AREA.history_head,e,{rows:[]},c.FIELDS.pk_ct_price_b)}})}}},{key:"getData",value:function(){var e=this,a={pk_oid:[this.props.pk_oid],pageId:c.PAGECODE.history,areacode:c.AREA.history_head};(0,l.ajax)({url:c.ACTION_URL.queryHistory,data:a,success:function(a){a.success&&a.data?e.props.insertTable.setInsertTableValue(c.AREA.history_head,a.data[c.AREA.history_head],c.FIELDS.pk_ct_price):e.props.insertTable.setInsertTableValue(c.AREA.history_head,{rows:[]},c.FIELDS.pk_ct_price)}})}},{key:"render",value:function(){var e=this.props.insertTable.createInsertTable;return i.default.createElement("div",{className:"scm-wrap"},i.default.createElement("div",{className:"table-area"},e({headTableId:c.AREA.history_head,bodyTableId:c.AREA.history_body,comType:"normal",setTableBodyData:this.setTableBodyData.bind(this)})))}}]),a}();a.History=u=(0,l.createPage)({initTemplate:d.initTemplate})(u),a.History=u},171:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.initTemplate=void 0;var r,n=t(172),o=(r=n)&&r.__esModule?r:{default:r};a.initTemplate=o.default},172:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a={pagecode:n.PAGECODE.history};(0,r.ajax)({url:n.ACTION_URL.merge,data:a,success:function(a){var t=a.data;e.meta.setMeta(t)}})};var r=t(0),n=t(8)},2:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.getLangByResId=a.initLang=void 0;var r=t(0);a.initLang=function(e,a,t,n){e.lang=null,e.inlt=null,(0,r.getMultiLang)({moduleId:a,domainName:t,callback:function(a,t,r){t&&(e.lang=a,e.inlt=r),n&&n()},needInlt:!0})},a.getLangByResId=function(e,a,t){return function(e,a){if(!e)throw(0,r.toast)({color:"danger",content:"请检查代码中this是否能够取到！当前为undifined,位置："+a}),new Error("请检查代码中this是否能够取到！当前为undifined,位置："+a)}(e,a),t?e.inlt?e.inlt.get(a,t)||a:"":e.lang?e.lang[a]||a:""}},214:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.history=function(e){var a=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_oid).value;i.call(this,e,a)},a.historyInner=function(e,a,t,r,n){var o=r.pk_oid.value;i.call(this,e,o)};t(0);var r=t(8),n=t(170),o=t(2);function i(e,a){e.modal.show("HistoryDlg",{size:"xlg",title:(0,o.getLangByResId)(this,"4004PRICE-000008"),noFooter:!0,content:React.createElement("div",null,React.createElement(n.History,{pk_oid:a,props:e}))})}},219:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.copy=function(e){(function(e){var a={pk_ct_price:{display:null,value:null},vcode:{display:null,value:null},vname:{display:null,value:null},creationtime:{display:null,value:null},creator:{display:null,value:null},modifiedtime:{display:null,value:null},modifier:{display:null,value:null},pk_oid:{display:null,value:null}};console.log(a),e.form.setFormItemsValue(r.AREA.card_head,a)})(e),function(e){e.cardTable.getAllRows(r.AREA.card_body).forEach(function(a,t){e.cardTable.setValByKeyAndIndex(r.AREA.card_body,t,r.FIELDS.pk_ct_price,{value:null,display:null,scale:-1}),e.cardTable.setValByKeyAndIndex(r.AREA.card_body,t,r.FIELDS.pk_ct_price_b,{value:null,display:null,scale:-1})})}(e),function(e){var a={bvalidateflag:{display:null,value:!1},blatest:{display:null,value:!0},iversion:{display:1,value:1}};console.log(a),e.form.setFormItemsValue(r.AREA.card_head,a)}(e),this.isAdd=!0,this.save_url=r.ACTION_URL.save,n.togglePageStatus.call(this,e,r.UISTATUS.edit)};var r=t(8),n=t(45);t(57)},220:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.bodyInnerButtonClick=a.buttonClick=void 0;t(3);var r=t(8),n=t(346),o=t(347),i=t(348),c=t(349),l=t(90),d=t(350),s=t(352),u=t(353),f=t(219),p=t(354),h=t(214),A=t(355),b=I(t(356)),_=I(t(357)),v=I(t(358)),y=I(t(359)),g=I(t(360)),E=I(t(361)),m=I(t(362)),R=I(t(363));function I(e){return e&&e.__esModule?e:{default:e}}a.buttonClick=function(e,a,t,v,y){switch(a){case r.BUTTON_CARD.Add:l.add.call(this,e);break;case r.BUTTON_CARD.Refresh:p.refresh.call(this,e);break;case r.BUTTON_CARD.Save:n.save.call(this,e);break;case r.BUTTON_CARD.Copy:f.copy.call(this,e);break;case r.BUTTON_CARD.Delete:d.deleteBtnClick.call(this,e);break;case r.BUTTON_CARD.Edit:i.editButtonClick.call(this,e);break;case r.BUTTON_CARD.Validate:s.validate.call(this,e);break;case r.BUTTON_CARD.UnValidate:u.unvalidate.call(this,e);break;case r.BUTTON_CARD.Cancel:c.cancel.call(this,e);break;case r.BUTTON_CARD.AddLine:o.addLine.call(this,e,a,t,v,y);break;case r.BUTTON_CARD.History:h.history.call(this,e);break;case r.BUTTON_CARD.Print:A.printPrice.call(this,e);break;case r.BUTTON_CARD.DeleteLine:b.default.call(this,e);break;case r.BUTTON_CARD.ReorderLineNumber:_.default.call(this,e);break;case r.BUTTON_CARD.CopyLine:E.default.call(this,e);break;case r.BUTTON_CARD.CancelPaste:g.default.call(this,e);break;case r.BUTTON_CARD.PasteToLast:m.default.call(this,e)}},a.bodyInnerButtonClick=function(e,a,t,n,o){switch(a){case r.BUTTON_CARD.DeleteLineInner:v.default.call(this,e,a,t,n,o);break;case r.BUTTON_CARD.InsertLineInner:y.default.call(this,e,a,t,n,o);break;case r.BUTTON_CARD.PasteThere:R.default.call(this,e,a,t,n,o)}}},26:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.clearTransferCache=a.rewriteTransferSrcBids=a.updateCacheDataForList=a.deleteCacheDataForList=a.getNextId=a.getCurrentLastId=a.getDefData=a.setDefData=a.hasListCache=a.addCacheData=a.getCacheDataByPk=a.deleteCacheData=a.updateCacheData=a.changeUrlParam=void 0;var r=t(0);a.changeUrlParam=function(e,a){e.setUrlParam(a)},a.updateCacheData=function(e,a,t,n,o,i){r.cardCache.addCache;var c=r.cardCache.updateCache;r.cardCache.getCacheById,c(a,t,n,o,i)},a.deleteCacheData=function(e,a,t,n){var o=r.cardCache.deleteCacheById;r.cardCache.getNextId,o(a,t,n)},a.getCacheDataByPk=function(e,a,t){return(0,r.cardCache.getCacheById)(t,a)},a.addCacheData=function(e,a,t,n,o,i){(0,r.cardCache.addCache)(t,n,o,i)},a.hasListCache=function(e,a){return e.table.hasCacheData(a)},a.setDefData=function(e,a,t){(0,r.cardCache.setDefData)(a,e,t)},a.getDefData=function(e,a){return(0,r.cardCache.getDefData)(a,e)},a.getCurrentLastId=function(e){return(0,r.cardCache.getCurrentLastId)(e)},a.getNextId=function(e,a,t){return(0,r.cardCache.getNextId)(a,t)},a.deleteCacheDataForList=function(e,a,t){t instanceof Array?t.forEach(function(t){e.table.deleteCacheId(a,t)}):e.table.deleteCacheId(a,t)},a.updateCacheDataForList=function(e,a,t,r,n){var o=r.sucessVOs;if(null!=o&&0!=o.length){var i=[];if(null==n){var c={};e.table.getCheckedRows(a).forEach(function(e){var a=e.data.values[t].value;c[a]=e.index}),o[a].rows.forEach(function(e,a){var r=e.values[t].value,n={index:c[r],data:{values:e.values}};i.push(n)})}else{var l={index:n,data:{values:o[a].rows[0].values}};i.push(l)}e.table.updateDataByIndexs(a,i)}},a.rewriteTransferSrcBids=function(e,a,t){if(t){var r=[];t.forEach(function(e){r.push(e.values[a].value)}),e.transferTable.setSavedTransferTableDataPk(r)}},a.clearTransferCache=function(e,a){e.transferTable.deleteCache(a)}},3:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.showQuitTransferWarningDialog=a.showBackWarningDialog=a.showBatchOprReturnMessage=a.showQueryResultInfoForNoPage=a.showSaveInfo=a.showRefreshInfo=a.showNoQueryResultInfo=a.showHasQueryResultInfo=a.showChangeOrgDialog=a.showDeleteDialog=a.showSingleDeleteDialog=a.showCancelDialog=a.showBatchOperateInfo=a.showBatchOprMessage=a.showWarningDialog=a.showErrorDialog=a.showInfoDialog=a.showSuccessDialog=a.showInfoInfo=a.showErrorInfo=a.showWarningInfo=a.showSuccessInfo=void 0;var r=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),n=t(0);var o=new(function(){function e(){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),this.lang=null,this.inlt=null,console.log("LangContainer初始化"),(0,n.getMultiLang)({moduleId:"4001pubmessage",domainName:"scmpub",callback:this.init.bind(this),needInlt:!0})}return r(e,[{key:"init",value:function(e,a,t){a&&(this.lang=e,this.inlt=t)}},{key:"getLangByResId",value:function(e,a){return a?this.inlt.get(e,a)||e:this.lang&&this.lang[e]||e}}]),e}());function i(e,a,t){l(e,a,t)}function c(e,a,t){l(e,a,t,"warning")}function l(e,a,t,r,o,i,c,l,d){(0,n.toast)({duration:t,color:r,title:e,content:a,groupOperation:o,TextArr:i,groupOperationMsg:c,onExpand:l,onClose:d})}function d(e,a){s(e,a,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},"warning")}function s(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];(0,n.promptBox)({color:r,title:e,content:a,noFooter:t.noFooter,noCancelBtn:t.noCancelBtn,beSureBtnName:t.beSureBtnName,cancelBtnName:t.cancelBtnName,beSureBtnClick:t.beSureBtnClick,cancelBtnClick:t.cancelBtnClick,closeBtnClick:t.closeBtnClick,closeByClickBackDrop:t.closeByClickBackDrop})}function u(){c(null,o.getLangByResId("4001PUBMESSAGE-000016"))}a.showSuccessInfo=i,a.showWarningInfo=c,a.showErrorInfo=function(e,a){l(e,a,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"infinity","danger")},a.showInfoInfo=function(e,a,t){l(e,a,t,"info")},a.showSuccessDialog=function(e,a){s(e,a,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})},a.showInfoDialog=function(e,a){s(e,a,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},"info")},a.showErrorDialog=function(e,a){s(e,a,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},"danger")},a.showWarningDialog=d,a.showBatchOprMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.getLangByResId("4001PUBMESSAGE-000003"),a=arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c=a.failedNum,l=a.sucessNum;if(0==c)i(o.getLangByResId("4001PUBMESSAGE-000018",{0:r}),o.getLangByResId("4001PUBMESSAGE-000022",{0:a.sucessNum}));else if(0==l){e=o.getLangByResId("4001PUBMESSAGE-000019",{0:r});var d=o.getLangByResId("4001PUBMESSAGE-000020",{0:a.failedNum,1:a.failedNum});(0,n.toast)({duration:"infinity",color:"danger",title:e,content:d,groupOperation:!0,TextArr:[o.getLangByResId("4001PUBMESSAGE-000000"),o.getLangByResId("4001PUBMESSAGE-000001"),o.getLangByResId("4001PUBMESSAGE-000002")],groupOperationMsg:a.errorMessages,onExpand:t.onExpand,onClose:t.onClose})}else{e=o.getLangByResId("4001PUBMESSAGE-000019",{0:r});var s=o.getLangByResId("4001PUBMESSAGE-000021",{0:Number(a.sucessNum)+Number(a.failedNum),1:a.sucessNum,2:a.failedNum});(0,n.toast)({duration:"infinity",color:"danger",title:e,content:s,groupOperation:!0,TextArr:[o.getLangByResId("4001PUBMESSAGE-000000"),o.getLangByResId("4001PUBMESSAGE-000001"),o.getLangByResId("4001PUBMESSAGE-000002")],groupOperationMsg:a.errorMessages,onExpand:t.onExpand,onClose:t.onClose})}},a.showBatchOperateInfo=function(e,a,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};l(e,a,"infinity","danger",!0,[o.getLangByResId("4001PUBMESSAGE-000000"),o.getLangByResId("4001PUBMESSAGE-000001"),o.getLangByResId("4001PUBMESSAGE-000002")],t,r.onExpand,r.onClose)},a.showCancelDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(o.getLangByResId("4001PUBMESSAGE-000007"),o.getLangByResId("4001PUBMESSAGE-000008"),e)},a.showSingleDeleteDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(o.getLangByResId("4001PUBMESSAGE-000009"),o.getLangByResId("4001PUBMESSAGE-000010"),e)},a.showDeleteDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(o.getLangByResId("4001PUBMESSAGE-000009"),o.getLangByResId("4001PUBMESSAGE-000011"),e)},a.showChangeOrgDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(o.getLangByResId("4001PUBMESSAGE-000012"),o.getLangByResId("4001PUBMESSAGE-000013"),e)},a.showHasQueryResultInfo=function(e){i(null,e?o.getLangByResId("4001PUBMESSAGE-000015",{1:e}):o.getLangByResId("4001PUBMESSAGE-000014"))},a.showNoQueryResultInfo=u,a.showRefreshInfo=function(){i(o.getLangByResId("4001PUBMESSAGE-000017"))},a.showSaveInfo=function(){i(o.getLangByResId("4001PUBMESSAGE-000023"))},a.showQueryResultInfoForNoPage=function(e){e?i(null,o.getLangByResId("4001PUBMESSAGE-000015",{1:e})):u()},a.showBatchOprReturnMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.getLangByResId("4001PUBMESSAGE-000003"),a=arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c="",l=a.failedNum,d=a.sucessNum;if(0==l)i(o.getLangByResId("4001PUBMESSAGE-000018",{0:r}),o.getLangByResId("4001PUBMESSAGE-000022",{0:a.sucessNum})),c=o.getLangByResId("4001PUBMESSAGE-000022",{0:a.sucessNum});else if(0==d){e=o.getLangByResId("4001PUBMESSAGE-000019",{0:r});var s=o.getLangByResId("4001PUBMESSAGE-000020",{0:a.failedNum,1:a.failedNum});(0,n.toast)({duration:"infinity",color:"danger",title:e,content:s,groupOperation:!0,TextArr:[o.getLangByResId("4001PUBMESSAGE-000000"),o.getLangByResId("4001PUBMESSAGE-000001"),o.getLangByResId("4001PUBMESSAGE-000002")],groupOperationMsg:a.errorMessages,onExpand:t.onExpand,onClose:t.onClose,customBtn:t.customBtn}),a.errorMessages.forEach(function(e){c+=e})}else{e=o.getLangByResId("4001PUBMESSAGE-000019",{0:r});var u=o.getLangByResId("4001PUBMESSAGE-000021",{0:Number(a.sucessNum)+Number(a.failedNum),1:a.sucessNum,2:a.failedNum});(0,n.toast)({duration:"infinity",color:"danger",title:e,content:u,groupOperation:!0,TextArr:[o.getLangByResId("4001PUBMESSAGE-000000"),o.getLangByResId("4001PUBMESSAGE-000001"),o.getLangByResId("4001PUBMESSAGE-000002")],groupOperationMsg:a.errorMessages,onExpand:t.onExpand,onClose:t.onClose,customBtn:t.customBtn}),a.errorMessages.forEach(function(e){c+=e})}return c},a.showBackWarningDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(o.getLangByResId("4001PUBMESSAGE-000024"),o.getLangByResId("4001PUBMESSAGE-000025"),e,"warning")},a.showQuitTransferWarningDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(o.getLangByResId("4001PUBMESSAGE-000026"),o.getLangByResId("4001PUBMESSAGE-000027"),e,"warning")}},341:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,n,o=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),i=t(342),c=t(8),l=t(10),d=E(l),s=t(0),u=t(220),f=t(364),p=t(367),h=t(7),A=t(169),b=(t(3),t(47)),_=t(59),v=t(2),y=E(t(104)),g=t(56);function E(e){return e&&e.__esModule?e:{default:e}}function m(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var R=s.base.NCAffix,I=s.base.NCDiv,T=(r=function(e){function a(e){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return n.call(t),t.state={},t.UIStatus="",t.save_url=c.ACTION_URL.save,t.mainOrg="",t.isAdd=!0,t.bvalidateflag="",t.iversion="",t.isFromPurdaily=!1,(0,v.initLang)(t,["4004price"],"ct",i.initTemplate.bind(t,e)),t}return function(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,l.Component),o(a,[{key:"componentWillMount",value:function(){var e=this;window.onbeforeunload=function(){if((e.UIStatus||c.UISTATUS.browse)==c.UISTATUS.edit)return(0,v.getLangByResId)(e,"4004PRICE-000026")}}},{key:"onSelected",value:function(e,a,t,r,n){if(this.UIStatus!=c.UISTATUS.browse){var o=e.cardTable.getCheckedRows(c.AREA.card_body);!o||o.length<=0?(0,b.exitCopyStatus)(e):e.button.setButtonDisabled([c.BUTTON_CARD.CopyLine,c.BUTTON_CARD.DeleteLine],!1)}}},{key:"onSelectedAll",value:function(e,a,t,r){this.onSelected(e,a)}},{key:"render",value:function(){var e=this.props,a=e.cardTable,t=e.form,r=e.button,n=e.cardPagination,o=e.modal,i=t.createForm,l=n.createCardPagination,s=a.createCardTable,h=o.createModal,A=(r.createButton,r.createButtonApp);return d.default.createElement("div",{className:"nc-bill-card",id:"pu_PoOrderCard_Page"},d.default.createElement("div",{className:"nc-bill-top-area"},d.default.createElement(R,null,d.default.createElement(I,{areaCode:I.config.HEADER,className:"nc-bill-header-area"},d.default.createElement("div",{className:"header-title-search-area"},(0,g.createCardTitle)(this,{backBtnClick:this.backToList.bind(this)})),d.default.createElement("div",{className:"header-button-area"},A({area:c.AREA.card_head,onButtonClick:u.buttonClick.bind(this)})),d.default.createElement("div",{className:"header-cardPagination-area"},l({handlePageInfoChange:this.pageQueryClick.bind(this),dataSource:c.PriceCache.PriceCacheKey})))),d.default.createElement("div",{className:"bc-bill-form-area"},i(c.AREA.card_head,{onAfterEvent:p.cardHeadAfterEdit.bind(this),onBeforeEvent:f.doHeadBeforeEdit.bind(this)}))),d.default.createElement("div",{className:"nc-bill-bottom-area"},d.default.createElement("div",{className:"header-button-area nc-bill-tableTab-area"},s(c.AREA.card_body,{showindex:!0,showCheck:!0,hideColSet:function(){return!1},hideSwitch:function(){return!1},tableHead:this.getTableHead.bind(this),onBeforeEvent:f.doBodyBeforeEdit.bind(this),onAfterEvent:p.cardBodyAfterEdit.bind(this),onSelected:this.onSelected.bind(this),onSelectedAll:this.onSelectedAll.bind(this),inputChange:y.default.bind(this,"crowno"),adaptionHeight:!0}))),h("HistoryDlg"))}}]),a}(),n=function(){var e=this;this.backToList=function(){e.props.pushTo("/list",{isBack:!0})},this.getTableHead=function(){var a=e.props.button.createButtonApp;return d.default.createElement("div",{className:"definition-icons"},a({area:c.AREA.card_body,onButtonClick:u.buttonClick.bind(e)}))},this.pageQueryClick=function(a,t){var r=(0,h.getCacheDataByPk)(e.props,c.PriceCache.PriceCacheKey,t);if(r){if(r.head&&a.form.setAllFormValue(m({},c.AREA.card_head,r.head[c.AREA.card_head])),r.body&&r.body[c.AREA.card_body]){var n=r.body[c.AREA.card_body];a.cardTable.setTableData(c.AREA.card_body,n,null,!0,!0)}var o=r.head[c.AREA.card_head].rows[0].values.pk_pricetemplet.value,i=r.head[c.AREA.card_head].rows[0].values.pk_ct_price.value;_.handleDynamicColumn.call(e,a,i,o,c.AREA.card_body),e.bvalidateflag=a.form.getFormItemsValue(c.AREA.card_head,c.FIELDS.bvalidateflag).value,e.iversion=a.form.getFormItemsValue(c.AREA.card_head,c.FIELDS.iversion).value,b.buttonController.call(e,a,e.UIStatus)}else a.setUrlParam(t),A.queryPriceData.call(e,a,t).then(function(t){b.buttonController.call(e,a,e.UIStatus)})}},r);T=(0,s.createPage)({billinfo:{billtype:"card",pagecode:c.PAGECODE.card,headcode:c.AREA.card_head,bodycode:m({},c.AREA.card_body,"cardTable")}})(T),a.default=T},342:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.initTemplate=void 0;var r=t(343);a.initTemplate=r.initTemplate},343:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.initTemplate=function(e){var a=this;e.createUIDom({appcode:r.APPCODE,pagecode:r.PAGECODE.card},function(t){if(t){if(t.context&&(a.mainOrg=t.context.pk_org),t.template){var r=t.template;l.call(a,e,r),e.meta.setMeta(r,function(){n.cardPageSetUp.call(a,e)})}if(t.button){var o=t.button;e.button.setButtons(o)}}})};var r=t(8),n=(t(45),t(344)),o=t(345),i=t(220),c=t(2);function l(e,a){return o.initConditionFilter.call(this,e,a),d.call(this,e,a),a}function d(e,a){var t=this,n={attrcode:"opr",label:(0,c.getLangByResId)(this,"4004PRICE-000016"),width:140,visible:!0,fixed:"right",itemtype:"customer",render:function(a,n,o){var c=[r.BUTTON_CARD.DeleteLineInner,r.BUTTON_CARD.InsertLineInner,r.BUTTON_CARD.PasteThere];return e.button.createOprationButton(c,{area:r.AREA.card_body_inner,buttonLimit:3,onButtonClick:function(e,r){return i.bodyInnerButtonClick.call(t,e,r,a,n,o)}})}};a[r.AREA.card_body].items.push(n)}},344:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.cardPageSetUp=void 0;t(3);var r=t(8),n=(t(0),t(45)),o=(t(57),t(169)),i=t(219),c=t(90);function l(e,a){n.togglePageStatus.call(this,e,a),e.form.setFormStatus(r.AREA.card_head,a)}a.cardPageSetUp=function(e){var a=this,t=e.getUrlParam,n=t("id")?t("id"):"",d=t("status"),s=t("copy"),u=t("pk_org"),f=t("pk_ct_pu"),p=t("pk_ct_price"),h=t("ctrantypeid"),A=t("nqtorigtaxprice");n||d!=r.UISTATUS.edit?o.queryPriceData.call(this,e,n,u,f,p,h,A).then(function(){a.isFromPurdaily&&(d=r.UISTATUS.browse),l.call(a,e,d),a.isFromPurdaily&&(e.button.setButtonVisible([r.BUTTON_CARD.Add,r.BUTTON_CARD.Edit,r.BUTTON_CARD.Copy,r.BUTTON_CARD.Validate,r.BUTTON_CARD.UnValidate],!1),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1),e.BillHeadInfo.setBillHeadInfoVisible({showBackBtn:!1}))}).then(function(){!0===s?i.copy.call(a,e):n&&d==r.UISTATUS.edit&&(a.save_url=r.ACTION_URL.update,a.isAdd=!1)}):c.add.call(this,e)}},345:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.initConditionFilter=function(e,a){a[r.AREA.card_head].items.map(function(a){r.FIELDS.pk_org==a.attrcode?a.queryCondition=function(){return{isDataPowerEnable:!0,GridRefActionExt:"nccloud.web.scmpub.ref.AppPermissionOrgRefFilter"}}:n.includes(a.attrcode)?a.queryCondition=function(){var a=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org),t={};return(a=a&&a.value||"")&&(t.pk_org=a),t}:(a.attrcode.indexOf("vdef")||a.attrcode.indexOf("vbdef"))&&"204"==a.datatype&&(a.queryCondition=function(){var a=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org),t={};return(a=a&&a.value||"")&&a.indexOf(",")<0&&(t.pk_org=a),t})}),a[r.AREA.card_body].items.map(function(a){r.FIELDS.pk_puorg==a.attrcode?a.isMultiSelectedEnabled=!0:r.FIELDS.orgregion==a.attrcode&&(a.queryCondition=function(){return{pk_org:e.form.getFormItemsValue(r.AREA.card_body,r.FIELDS.pk_org),pk_material:e.form.getFormItemsValue(r.AREA.card_body,r.FIELDS.pk_material),pk_marbasclass:e.form.getFormItemsValue(r.AREA.card_body,r.FIELDS.pk_marbasclass),GridRefActionExt:"nccloud.web.ct.price.ref.RegionRefFilter"}})})};var r=t(8),n=[r.FIELDS.cvendorid,r.FIELDS.pk_marbasclass,r.FIELDS.pk_material]},346:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.save=void 0;var r=t(8),n=t(3),o=t(0),i=t(45),c=(t(7),t(57)),l=t(2);a.save=function(e){var a=this,t=e.cardTable,d=e.createMasterChildDataSimple,s=e.form,u=t.filterEmptyRows,f=s.isCheckNow;u(r.AREA.card_body);var p=d(r.PAGECODE.card,r.AREA.card_head,r.AREA.card_body);!function(e){if(e&&e.body&&e.body[r.AREA.card_body]&&e.body[r.AREA.card_body].rows){var a=[];e.body[r.AREA.card_body].rows.forEach(function(e){e.status!=r.VOSTATUS.DELETE&&a.push(e)}),e.body[r.AREA.card_body].rows=a}}(p),f(r.AREA.card_head)&&e.validateToSave(p,function(){(0,o.ajax)({url:a.save_url,data:p,success:function(t){var o,d,s;console.log(t),e.cardTable.selectAllRows(r.AREA.card_body,!1),t.data.head&&e.form.setAllFormValue((o={},d=r.AREA.card_head,s=t.data.head[r.AREA.card_head],d in o?Object.defineProperty(o,d,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[d]=s,o)),t.data.body&&e.cardTable.updateDataByRowId(r.AREA.card_body,t.data.body[r.AREA.card_body],!0,!0);var u=t.data.head[r.AREA.card_head].rows[0].values.pk_ct_price.value,f=a.isAdd;(0,c.refreshcache)(e,f,t.data,u,r.PriceCache.PriceCacheKey),a.bvalidateflag=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.bvalidateflag).value,a.iversion=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.iversion).value,(0,n.showSuccessInfo)((0,l.getLangByResId)(a,"4004PRICE-000011")),i.togglePageStatus.call(a,e,r.UISTATUS.browse)}})})}},347:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.addLine=void 0;var r=t(8),n=t(46);a.addLine=function(e,a,t,o,i){var c=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_group),l=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org),d=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_ct_price);e.cardTable.addRow(r.AREA.card_body,i,{pk_org:{display:l.display,value:l.value},pk_group:{display:c.display,value:c.value},pk_ct_price:{display:d.display,value:d.value}}),n.RownoUtils.setRowNo(e,r.AREA.card_body)}},348:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.editButtonClick=void 0;var r=t(8),n=t(45);a.editButtonClick=function(e){var a=e.form,t=e.cardTable,o=a.setFormStatus,i=t.setStatus,c=t.selectAllRows;o(r.AREA.card_head,r.UISTATUS.edit),i(r.AREA.card_body,r.UISTATUS.edit),n.togglePageStatus.call(this,e,r.UISTATUS.edit),c(r.AREA.card_body,!1),this.save_url=r.ACTION_URL.update,this.isAdd=!1}},349:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.cancel=void 0;var r=t(8),n=t(45),o=t(0),i=t(57),c=t(3);o.cardCache.getCurrentLastId;a.cancel=function(e){var a=this;(0,c.showCancelDialog)({beSureBtnClick:function(){var t=e.form,o=e.cardTable.resetTableData;(0,t.cancel)(r.AREA.card_head),o(r.AREA.card_body),a.isAdd?(0,i.fillCurrentBill)(e,function(){n.togglePageStatus.call(a,e,r.UISTATUS.browse)}):n.togglePageStatus.call(a,e,r.UISTATUS.browse)}})}},350:function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.deleteBtnClick=function(a){var t=this,s=a.form.getFormItemsValue;if(!0===s(r.AREA.card_head,r.FIELDS.bvalidateflag).value)return void(0,i.showErrorInfo)((0,u.getLangByResId)(this,"4004PRICE-000004"));(0,i.showSingleDeleteDialog)({beSureBtnClick:function(){var p=s(r.AREA.card_head,r.FIELDS.pk_ct_price).value,h=s(r.AREA.card_head,r.FIELDS.ts).value,A={pks:[p],queryRecently:!0,tss:[h]};(0,n.ajax)({url:r.ACTION_URL.delete,data:A,success:function(n){if(n.success){if((0,c.deleteCacheData)(a,r.FIELDS.pk_ct_price,p,r.PriceCache.PriceCacheKey),(0,i.showSuccessInfo)((0,u.getLangByResId)(t,"4004PRICE-000005")),n.data)return f.call(t,a,n.data),void l.togglePageStatus.call(t,a,r.UISTATUS.browse);var s=(0,c.getNextId)(e,p,r.PriceCache.PriceCacheKey);if(!s)return a.form.EmptyAllFormValue(r.AREA.card_head),a.cardTable.setTableData(r.AREA.card_body,{rows:[]}),(0,d.clearPriceItems)(a),(0,d.hiddenPriceItems)(a),void l.togglePageStatus.call(t,a,r.UISTATUS.browse);(0,c.changeUrlParam)(a,{status:r.UISTATUS.browse,id:s}),(0,o.fillCurrentBill)(a,null,s)}}})}})};var r=t(8),n=t(0),o=t(57),i=t(3),c=t(7),l=t(45),d=t(89),s=t(59),u=t(2);function f(e,a){var t,n,o;if(a.head&&e.form.setAllFormValue((t={},n=r.AREA.card_head,o=a.head[r.AREA.card_head],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t)),a.body&&a.body[r.AREA.card_body]){var i=a.body[r.AREA.card_body];e.cardTable.setTableData(r.AREA.card_body,i,null,!0,!0)}var l=a.head[r.AREA.card_head].rows[0].values,d=l.pk_pricetemplet.value,u=l.pk_ct_price.value;s.handleDynamicColumn.call(this,e,u,d,r.AREA.card_body),this.bvalidateflag=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.bvalidateflag).value,this.iversion=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.iversion).value,(0,c.addCacheData)(e,"pk_ct_price",u,a,r.AREA.card_head,r.PriceCache.PriceCacheKey)}}).call(this,t(351))},351:function(e,a){var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var l,d=[],s=!1,u=-1;function f(){s&&l&&(s=!1,l.length?d=l.concat(d):u=-1,d.length&&p())}function p(){if(!s){var e=c(f);s=!0;for(var a=d.length;a;){for(l=d,d=[];++u<a;)l&&l[u].run();u=-1,a=d.length}l=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(a){try{return r.call(null,e)}catch(a){return r.call(this,e)}}}(e)}}function h(e,a){this.fun=e,this.array=a}function A(){}n.nextTick=function(e){var a=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)a[t-1]=arguments[t];d.push(new h(e,a)),1!==d.length||s||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=A,n.addListener=A,n.once=A,n.off=A,n.removeListener=A,n.removeAllListeners=A,n.emit=A,n.prependListener=A,n.prependOnceListener=A,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},352:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.validate=void 0;var r=t(8),n=t(3),o=t(0),i=t(57),c=t(45),l=t(2);a.validate=function(e){var a=this,t=e.form,d=t.getFormItemsValue,s=(t.setFormItemsValue,d(r.AREA.card_head,r.FIELDS.pk_ct_price).value),u=d(r.AREA.card_head,r.FIELDS.ts).value,f=d(r.AREA.card_head,r.FIELDS.pk_oid).value,p={heads:[{pk_ct_price:s,ts:u,pk_oid:f}],pageId:r.PAGECODE.card};(0,o.ajax)({url:r.ACTION_URL.validate,data:p,success:function(t){if(t.success){e.form.setAllFormValue((d={},u=r.AREA.card_head,f=t.data.head[r.AREA.card_head],u in d?Object.defineProperty(d,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[u]=f,d));var o=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.bvalidateflag).value;a.bvalidateflag=o,(0,i.refreshcache)(e,!1,t.data,s,r.PriceCache.PriceCacheKey),c.togglePageStatus.call(a,e,a.UIStatus),(0,n.showSuccessInfo)((0,l.getLangByResId)(a,"4004PRICE-000014"))}var d,u,f}})}},353:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.unvalidate=void 0;var r=t(8),n=t(3),o=t(0),i=t(57),c=t(45),l=t(2);function d(e){var a=this,t=e.form,d=t.getFormItemsValue,s=(t.setFormItemsValue,d(r.AREA.card_head,r.FIELDS.pk_ct_price).value),u=d(r.AREA.card_head,r.FIELDS.ts).value,f=d(r.AREA.card_head,r.FIELDS.pk_oid).value,p={heads:[{pk_ct_price:s,ts:u,pk_oid:f}],pageId:r.PAGECODE.card};(0,o.ajax)({url:r.ACTION_URL.unvalidate,data:p,success:function(t){if(t.success){e.form.setAllFormValue((d={},u=r.AREA.card_head,f=t.data.head[r.AREA.card_head],u in d?Object.defineProperty(d,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[u]=f,d));var o=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.bvalidateflag).value;a.bvalidateflag=o,c.togglePageStatus.call(a,e,a.UIStatus),(0,i.refreshcache)(e,!1,t.data,s,r.PriceCache.PriceCacheKey),(0,n.showSuccessInfo)((0,l.getLangByResId)(a,"4004PRICE-000014"))}var d,u,f}})}a.unvalidate=function(e){var a=this;(0,n.showWarningDialog)((0,l.getLangByResId)(this,"4004PRICE-000012"),(0,l.getLangByResId)(this,"4004PRICE-000013"),{beSureBtnClick:function(){d.call(a,e)}})}},354:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.refresh=function(e){var a=this,t=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_ct_price);r.queryPriceData.call(this,e,t.value).then(function(t){(0,o.showSuccessInfo)((0,c.getLangByResId)(a,"4004PRICE-000010")),i.togglePageStatus.call(a,e,n.UISTATUS.browse)}).catch(function(e){})};var r=t(169),n=t(8),o=t(3),i=t(45),c=t(2)},355:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.printPrice=function(e){var a=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_ct_price).value;if(!a)return void(0,r.showWarningInfo)((0,i.getLangByResId)(this,"4004PRICE-000009"));var t=[a];(0,o.print)("pdf",n.ACTION_URL.print,{nodekey:null,oids:t})};var r=t(3),n=t(8),o=t(0),i=t(2)},356:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.cardTable.getCheckedRows(r.AREA.card_body);if(!a||a.length<=0)return void(0,n.showWarningInfo)((0,o.getLangByResId)(this,"4004PRICE-000006"));if(e.cardTable.getVisibleRows(r.AREA.card_body)<=1)return void(0,n.showWarningInfo)((0,o.getLangByResId)(this,"4004PRICE-000007"));var t=[];a.forEach(function(e){t.push(e.index)}),e.cardTable.delRowsByIndex(r.AREA.card_body,t)};var r=t(8),n=t(3),o=t(2)},357:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){n.RownoUtils.resetRowNo(e,r.AREA.card_body)};var r=t(8),n=t(46)},358:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e,a,t,i,c){if(e.cardTable.getVisibleRows(r.AREA.card_body)<=1)return void(0,n.showWarningInfo)((0,o.getLangByResId)(this,"4004PRICE-000007"));e.cardTable.delRowsByIndex(r.AREA.card_body,c)};var r=t(8),n=t(3),o=t(2)},359:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e,a,t,o,i){var c=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_group).value,l=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value,d=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_ct_price).value,s={values:{pk_org:{display:"",value:l},pk_group:{display:"",value:c},pk_ct_price:{display:"",value:d}}};e.cardTable.insertRowsAfterIndex(r.AREA.card_body,s,i-1),n.RownoUtils.setRowNo(e,r.AREA.card_body)};var r=t(8),n=t(46)},360:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){(0,n.exitCopyStatus)(e);var a=e.cardTable.getNumberOfRows(r.AREA.card_body),t=[].concat(function(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}(Array(a).keys()));e.cardTable.unSelectRowsByIndex(r.AREA.card_body,t)};var r=t(8),n=t(47)},361:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.cardTable.getCheckedRows(r.AREA.card_body);if(!a||a.length<=0)return void showWarningInfo((0,o.getLangByResId)(this,"4004PRICE-000003"));(0,n.intoCopyStatus)(e)};var r=t(8),n=t(47),o=t(2)},362:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.cardTable.getCheckedRows(r.AREA.card_body).map(function(e){var a=e.data;return a.values[r.FIELDS.pk_ct_price_b]={display:"",value:""},a});e.beforeUpdatePage();var t=e.cardTable.getNumberOfRows(r.AREA.card_body);e.cardTable.insertRowsAfterIndex(r.AREA.card_body,a,t-1),(0,n.exitCopyStatus)(e),function(e){var a=e.cardTable.getCheckedRows(r.AREA.card_body),t=[];a.forEach(function(e){t.push(e.index)}),e.cardTable.unSelectRowsByIndex(r.AREA.card_body,t)}(e),e.updatePage(r.AREA.card_head,r.AREA.card_body)};var r=t(8),n=t(47)},363:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e,a,t,o,i){var c=e.cardTable.getCheckedRows(r.AREA.card_body).map(function(e){var a=e.data;return a.values[r.FIELDS.pk_ct_price_b]={display:"",value:""},a});e.cardTable.insertRowsAfterIndex(r.AREA.card_body,c,i-1),(0,n.exitCopyStatus)(e),function(e){var a=e.cardTable.getCheckedRows(r.AREA.card_body),t=[];a.forEach(function(e){t.push(e.index)}),e.cardTable.unSelectRowsByIndex(r.AREA.card_body,t)}(e)};var r=t(8),n=t(47)},364:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.cardBeforEdit=function(e,a,t,n,o,l){if(!e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value)return!1;(a=r.AREA.card_head)&&i.call(this,e,a,t,n,o,l,!0);a==r.AREA.card_body&&c.call(this,e,a,t,n,o,l,!0);return!0},a.doHeadBeforeEdit=i,a.doBodyBeforeEdit=c;var r=t(8),n=t(365),o=t(366);function i(e,a,t,o,i){if(!e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value&&t!=r.FIELDS.pk_org)return!1;var c=e.meta.getMeta(),l=c[a].items.find(function(e){return e.attrcode==t}),d=!0;switch(t){case r.FIELDS.pk_org:d=n.pk_org_before.call(this,e,a,t,o,i,d,l);break;case r.FIELDS.pk_pricetemplet:d=n.pk_priceTemplate_before.call(this,e,a,t,o,i,d,l);break;case r.FIELDS.vcode:d=n.vcodeBefore.call(this,e,a,t,o,i,d,l)}return e.meta.setMeta(c),d}function c(e,a,t,n,i,c,l){if(!e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value&&t!=r.FIELDS.pk_org)return!1;var d=e.meta.getMeta(),s=(d[a].items.find(function(e){return e.attrcode==t}),!0);switch(t){case r.FIELDS.orgregion:s=o.orgregion_before.call(this,e,a,t,n,i,c,l)}return e.meta.setMeta(d),s}},365:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.pk_org_before=function(e,a,t,r,o,i,c){if(t==n.FIELDS.pk_org){return o.pk_ct_price&&o.pk_ct_price.value?(e.form.setFormItemsDisabled(n.AREA.card_head,l({},n.FIELDS.pk_org,!0)),!1):(e.form.setFormItemsDisabled(n.AREA.card_head,l({},n.FIELDS.pk_org,!1)),!0)}},a.pk_priceTemplate_before=function(e,a,t,r,o,i,c){var d=o.iversion.value,s=o.bvalidateflag.value;if(d>1||1==s)return e.form.setFormItemsDisabled(n.AREA.card_head,l({},n.FIELDS.pk_pricetemplet,!0)),!1;e.form.setFormItemsDisabled(n.AREA.card_head,l({},n.FIELDS.pk_pricetemplet,!1));return!0},a.vcodeBefore=function(e,a,t,r,i,l,d){var s=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_org);if(s&&s.value){var u={key:t,params:{pk_org:s.value,billtype:"ctprice"}},f=n.ACTION_URL.cardHeadBefore;return(0,c.ajax)({url:f,data:u,async:!1,success:function(e){l=e.data.isedit,e.data.message&&(0,o.showErrorInfo)(e.data.message)}}),l}return!1};var r,n=t(8),o=t(3),i=t(138),c=((r=i)&&r.__esModule,t(0));function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}},366:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.orgregion_before=function(e,a,t,o,i,c,l){var d=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_org),s=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_material),u=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_marbasclass),f={pk_org:d,pk_material:s,pk_marbasclass:u};(0,r.ajax)({url:n.ACTION_URL.cardBefore,data:f,success:function(e){if(e.success&&e.data){var a=e.data.ebpurEnabled;return console.log(a),a}}})};var r=t(0),n=t(8)},367:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.cardHeadAfterEdit=function(e,a,t,o,i){var c=e.meta.getMeta(),l=!0;switch(t){case r.FIELDS.cvendorid:l=n.cvendorid_after.call(this,e,a,t,o,i);break;case r.FIELDS.pk_material:l=n.material_after.call(this,e,a,t,o,i);break;case r.FIELDS.pk_marbasclass:l=n.marbasclass_after.call(this,e,a,t,o,i);break;case r.FIELDS.pk_pricetemplet:l=n.pricetemplet_after.call(this,e,a,t,o,i);break;case r.FIELDS.corigcurrencyid:l=n.corigcurrencyid_after.call(this,e,a,t,o,i);break;case r.FIELDS.pk_org:n.pk_org_after.call(this,e,a,t,o,i)}return e.meta.setMeta(c),l},a.cardBodyAfterEdit=function(e,a,t,n,i,c,l,d){var s=e.meta.getMeta(),u=!0;switch(t){case r.FIELDS.pk_puorg:u=o.pk_puorg_after.call(this,e,a,t,n,i,c,l,d)}return e.meta.setMeta(s),u};var r=t(8),n=t(89),o=t(368)},368:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.pk_puorg_after=function(e,a,t,i,c,l,d,s){var u=(0,o.createBodyAfterEventData)(e,n.PAGECODE.card,n.AREA.card_head,n.AREA.card_body,a,t,c,l);console.log(u),(0,r.ajax)({url:n.ACTION_URL.cardBodyAfter,data:u,success:function(t){(0,o.processBillCardBodyEditResult)(e,a,t.data,l)}})};var r=t(0),n=t(8),o=t(43)},43:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.processExtBillCardHeadEditResult=a.createExtBillHeadAfterEventData=a.processExtBillCardBodyEditResult=a.processGridEditResult=a.processBillCardBodyEditResultNotAddRow=a.processBillCardBodyEditResult=a.processBillCardHeadEditResult=a.createExtBodyAfterEventData=a.createHeadAfterEventData=a.createBodyAfterEventData=a.createGridAfterEventData=void 0;var r=t(48);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}a.createGridAfterEventData=function(e,a,t,o,i,c,l,d){var s=e.meta.getMeta(),u=e.editTable.getAllRows(t,!1),f=n({templetid:s.pageid,pageid:a},t,{areaType:"table",areacode:t,rows:[u[l]]});return f[t]=(0,r.simplifyData)(f[t]),{attrcode:i,changedrows:c,grid:f,index:0,userobject:d}},a.createBodyAfterEventData=function(e,a,t,n,o,i,c,l,d){var s=e.createBodyAfterEventData(a,t,n,o,i,c);s.index=0;var u=s.card.body[n].rows,f=[u[l]];s.card.body[n].rows=f,s.card.head[t]=(0,r.simplifyData)(s.card.head[t]),s.card.body[n]=(0,r.simplifyData)(s.card.body[n]),d=d||{};var p=[];return u.map(function(e){"3"!=e.status&&p.push(e.values.crowno?e.values.crowno.value:null)}),d.scm_originindex=l+"",d.scm_allrownos=p,s.userobject=d,s},a.createHeadAfterEventData=function(e,a,t,n,o,i,c,l,d){var s=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],u=e.createHeadAfterEventData(a,t,n,o,i,c);return u.card.head[t]=(0,r.simplifyData)(u.card.head[t]),u.card.body[n]=d?(0,r.simplifyDataByFields)(u.card.body[n],!0,d,s):(0,r.simplifyData)(u.card.body[n]),l=l||{},u.userobject=l,u},a.createExtBodyAfterEventData=function(e,a,t,n,o,i,c,l,d){var s=e.createBodyAfterEventData(a,t,n,o,i,c);s.index=0;var u=s.card.bodys[o].rows,f=[u[l]];s.card.bodys[o].rows=f,s.card.head[t]=(0,r.simplifyData)(s.card.head[t]),s.card.bodys[o]=(0,r.simplifyData)(s.card.bodys[o]),d=d||{};var p=[];return u.map(function(e){"3"!=e.status&&p.push(e.values.crowno?e.values.crowno.value:null)}),d.scm_originindex=l+"",d.scm_allrownos=p,s.userObject=d,s},a.processBillCardHeadEditResult=function(e,a,t,r){r&&r.billCard&&(r.billCard.head&&e.form.setAllFormValue(n({},a,r.billCard.head[a])),r.billCard.body&&e.cardTable.updateDiffDataByRowId(t,r.billCard.body[t]))},a.processBillCardBodyEditResult=function(e,a,t,r){if(t&&t.billCard&&t.billCard.body&&t.billCard.body[a]&&t.billCard.body[a].rows.length>0){for(var n=t.billCard.body[a].rows,o=[],i=[],c=0;c<n.length;c++){var l={index:r+c,data:n[c]};0==c?i.push(l):o.push(l)}i.length>0&&e.cardTable.updateDataByIndexs(a,i),o.length>0&&e.cardTable.insertDataByIndexs(a,o,!0)}},a.processBillCardBodyEditResultNotAddRow=function(e,a,t,r){if(t&&t.billCard&&t.billCard.body&&t.billCard.body[a]&&t.billCard.body[a].rows.length>0){for(var n=t.billCard.body[a].rows,o=[],i=[],c=0;c<n.length;c++){var l={index:r+c,data:n[c]};i.push(l)}i.length>0&&e.cardTable.updateDataByIndexs(a,i),o.length>0&&e.cardTable.insertDataByIndexs(a,o,!0)}},a.processGridEditResult=function(e,a,t,r){if(t&&t.grid&&t.grid[a]){for(var n=t.grid[a].rows,o=[],i=[],c=0;c<n.length;c++){var l={index:r+c,data:n[c]};0==c?i.push(l):o.push(l)}i.length>0&&e.editTable.updateDataByIndexs(a,i),o.length>0&&e.editTable.insertDataByIndexs(a,o,!0)}},a.processExtBillCardBodyEditResult=function(e,a,t){if(t.extbillcard&&t.extbillcard.bodys&&t.extbillcard.bodys[a]){var r=[],n=[],o=t.userObject&&t.userObject.scm_originindex?parseInt(t.userObject.scm_originindex):1;t.extbillcard.bodys[a].rows.forEach(function(e,a){e.rowid?r.push(e):n.push({index:a+o,data:e})}),e.cardTable.updateDataByRowId(a,{rows:r},!1,!1),e.cardTable.insertDataByIndexs(a,n,!0)}},a.createExtBillHeadAfterEventData=function(e,a,t,n,o,i,c,l){var d=e.createHeadAfterEventData(a,t,n,o,i,c);return d.card.head[t]=(0,r.simplifyData)(d.card.head[t],!1),n instanceof Array&&n.forEach(function(e){d.card.bodys[e]=(0,r.simplifyData)(d.card.bodys[e],!1)}),l=l||{},d.userobject=l,d},a.processExtBillCardHeadEditResult=function(e,a,t,r){r&&r.extbillcard&&(r.extbillcard.head&&e.form.setAllFormValue(n({},a,r.extbillcard.head[a])),r.extbillcard.bodys&&(t instanceof Array?t.forEach(function(a){r.extbillcard.bodys[a]&&e.cardTable.updateDiffDataByRowId(a,r.extbillcard.bodys[a])}):e.cardTable.updateDiffDataByRowId(t,r.extbillcard.bodys[t])))}},44:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.RownoUtils=a.rowCopyPasteUtils=void 0;var r=t(60),n=t(46);a.rowCopyPasteUtils=r.rowCopyPasteUtils,a.RownoUtils=n.RownoUtils},45:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.togglePageStatus=void 0;var r=t(47),n=t(8);a.togglePageStatus=function(e,a,t){this.UIStatus=a,r.buttonController.call(this,e,a);var o=e.cardTable,i=e.form.setFormStatus,c=o.setStatus;i(n.AREA.card_head,a),c(n.AREA.card_body,a),t&&"function"==typeof t&&t.call(this,e)}},46:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.RownoUtils=void 0;var r=t(0),n=0,o=8,i="crowno";function c(e,a,t,i,c){var l=i-c.length-1,d=(e.cardTable.getValByKeyAndIndex(a,l,t)||{}).value;d=d||n;var u=(e.cardTable.getValByKeyAndIndex(a,i,t)||{}).value,f=c.length,p=[];c.forEach(function(e){p.push(e)});for(var h=o;;){var A={};A[d]=!0,A[u]=!0;for(var b=0;b<f;b++){var _=p[b];if(new Number(d)-new Number(_)>=0||new Number(u)-new Number(_)<=0)break;A[_]=!0}if(Object.getOwnPropertyNames(A).length!==f+2)break;for(var v=0;v<f;v++)c[v]=p[v];if(h<=0)break;--h;for(var y=0;y<f;y++){var g=s((0,r.formatAcuracy)(p[y],h));p[y]="0.00000000"==g?"0.00000001":g}}return c}function l(e,a,t,r){for(var o=e.cardTable.getNumberOfRows(a),i=function(e,a,t,r){if(1===r)return n;for(var o=n,i=null,c=0;c<r;c++)(i=e.cardTable.getValByKeyAndIndex(a,c,t).value)&&Number(o)<Number(i)&&(o=Number(i));return o}(e,a,t,o),c=new Array(r.length),l=0;l<r.length;l++)c[l]=10*(l+1)+Number(i);return c}function d(e,a,t,i,c){var l=function(e,a,t,r){if(1==e.cardTable.getNumberOfRows(a))return n;for(var o=r-1;o>=0;o--){var i=(e.cardTable.getValByKeyAndIndex(a,o,t)||{}).value;if(""!=i&&null!=i)return i}return n}(e,a,t,i),d=e.cardTable.getValByKeyAndIndex(a,i,t).value,u=new Array(c.length);if(l===d)for(var f=0;f<c.length;f++)u[f]=l;else if(null==d||""==d)for(var p=0;p<c.length;p++)u[p]=10*(p+1)+Number(l);else for(var h=(d-l)/(c.length+1),A=l,b=0;b<c.length;b++){A=Number(A)+Number(h);var _=s((0,r.formatAcuracy)(A,o));u[b]="0.00000000"==_?"0.00000001":_}return u}function s(e){return e?e.toString().replace(/\,/gi,""):e}var u={setRowMaterilNo:function(e,a,t,r){null==t&&(t=i);for(var n=e.cardTable.getNumberOfRows(a),o=!0;n>0&&o;){for(var s=[],u=-1,f=0;f<n;f++){f==n-1&&(o=!1);var p=(e.cardTable.getValByKeyAndIndex(a,f,t)||{}).value,h=(e.cardTable.getValByKeyAndIndex(a,f,r)||{}).value;if(p||h){if(0==s.length)continue;u=f;break}s.push(f),u=-1}var A=null;A=-1!=u?c(e,a,t,u,A=d(e,a,t,u,s)):l(e,a,t,s);for(var b=0;b<s.length;b++){var _=s[b];e.cardTable.setValByKeyAndIndex(a,_,t,{value:A[b].toString(),display:A[b].toString()})}}},setRowNo:function(e,a,t){null==t&&(t=i);for(var r=e.cardTable.getNumberOfRows(a),n=!0;r>0&&n;){for(var o=[],s=-1,u=0;u<r;u++){if(u==r-1&&(n=!1),(e.cardTable.getValByKeyAndIndex(a,u,t)||{}).value){if(0==o.length)continue;s=u;break}o.push(u),s=-1}var f=null;f=-1!=s?c(e,a,t,s,f=d(e,a,t,s,o)):l(e,a,t,o);for(var p=0;p<o.length;p++){var h=o[p];e.cardTable.setValByKeyAndIndex(a,h,t,{value:f[p].toString(),display:f[p].toString()})}}},resetRowNo:function(e,a,t){null==t&&(t=i);for(var r=e.cardTable.getNumberOfRows(a),n=0;n<r;n++){var o=10*n+10;e.cardTable.setValByKeyAndIndex(a,n,t,{value:o.toString(),display:o.toString()})}}};a.RownoUtils=u},47:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.exitCopyStatus=a.intoCopyStatus=a.resetBodyButtons=a.buttonController=void 0;var r=t(8);function n(e){var a=e.button.setButtonVisible,t=this.bvalidateflag;a([r.BUTTON_CARD.Validate],!t),a([r.BUTTON_CARD.UnValidate],t),a(r.BUTTON_CARD.Delete,!t);var n=1==this.iversion;a([r.BUTTON_CARD.History],!n)}function o(e){e.button.setButtonDisabled([r.BUTTON_CARD.AddLine,r.BUTTON_CARD.DeleteLine,r.BUTTON_CARD.CopyLine,r.BUTTON_CARD.ReorderLineNumber],!0),e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value?e.button.setButtonDisabled([r.BUTTON_CARD.AddLine,r.BUTTON_CARD.ReorderLineNumber],!1):e.button.setButtonDisabled([r.BUTTON_CARD.AddLine,r.BUTTON_CARD.ReorderLineNumber],!0)}a.buttonController=function(e,a){var t=e.button.setButtonVisible;if(a==r.UISTATUS.browse){e.BillHeadInfo.setBillHeadInfoVisible({showBackBtn:!0});var i=e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_ct_price).value;if(!(i=i||e.getUrlParam(r.FIELDS.pk_ct_price)))return t(r.BUTTON_CARD_BROWSE,!1),t(r.BUTTON_CARD_EDIT,!1),void t(r.BUTTON_CARD.Add,!0);t(r.BUTTON_CARD_EDIT,!1),t(r.BUTTON_CARD_BROWSE,!0),t([r.BUTTON_CARD.Validate,r.BUTTON_CARD.UnValidate,r.BUTTON_CARD.History],!1),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0),n.call(this,e)}else a==r.UISTATUS.edit&&(t(r.BUTTON_CARD_BROWSE,!1),t(r.BUTTON_CARD_EDIT,!0),t([r.BUTTON_CARD.Validate,r.BUTTON_CARD.UnValidate,r.BUTTON_CARD.History,r.BUTTON_CARD.PasteThere,r.BUTTON_CARD.PasteToLast,r.BUTTON_CARD.CancelPaste],!1),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1),e.BillHeadInfo.setBillHeadInfoVisible({showBackBtn:!1}),o.call(this,e))},a.resetBodyButtons=o,a.intoCopyStatus=function(e){var a=e.button.setButtonVisible;a([r.BUTTON_CARD.AddLine,r.BUTTON_CARD.DeleteLine,r.BUTTON_CARD.CopyLine,r.BUTTON_CARD.ReorderLineNumber,r.BUTTON_CARD.InsertLineInner,r.BUTTON_CARD.DeleteLineInner],!1),a([r.BUTTON_CARD.PasteThere,r.BUTTON_CARD.PasteToLast,r.BUTTON_CARD.CancelPaste],!0)},a.exitCopyStatus=function(e){var a=e.button.setButtonVisible;a([r.BUTTON_CARD.PasteThere,r.BUTTON_CARD.PasteToLast,r.BUTTON_CARD.CancelPaste],!1),a([r.BUTTON_CARD.AddLine,r.BUTTON_CARD.DeleteLine,r.BUTTON_CARD.CopyLine,r.BUTTON_CARD.ReorderLineNumber,r.BUTTON_CARD.InsertLineInner,r.BUTTON_CARD.DeleteLineInner],!0),e.button.setButtonDisabled([r.BUTTON_CARD.CopyLine,r.BUTTON_CARD.DeleteLine],!0)}},48:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function n(e){for(var a=arguments.length,t=Array(a>1?a-1:0),r=1;r<a;r++)t[r-1]=arguments[r];return!(null!=e&&""!==e&&!t.find(function(a){return a==e}))}a.simplifyData=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&Array.isArray(e.rows)&&e.rows.length){var t=r({},e,{rows:[]});return e.rows.forEach(function(e){if(e.values){var o={};for(var i in e.values)e.values[i]&&(n(e.values[i].value)?a||-1==e.values[i].scale||(o[i]={scale:e.values[i].scale}):(o[i]={value:e.values[i].value},a||-1==e.values[i].scale||(o[i].scale=e.values[i].scale)));t.rows.push(r({},e,{values:o}))}}),t}return e},a.simplifyDataByFields=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e&&Array.isArray(e.rows)&&e.rows.length){var i=r({},e,{rows:[]});return e.rows.forEach(function(e){if(e.values){var c={};for(var l in e.values)t?o?t.includes(l)&&(c[l]={value:e.values[l].value}):t.includes(l)||(c[l]={value:e.values[l].value}):n(e.values[l].value)?a||-1==e.values[l].scale||(c[l]={scale:e.values[l].scale}):(c[l]={value:e.values[l].value},a||-1==e.values[l].scale||(c[l].scale=e.values[l].scale));i.rows.push(r({},e,{values:c}))}}),i}return e}},56:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function n(e,a){return a||e.props.getSearchParam("n")}a.createListTitle=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,e.props.BillHeadInfo.createBillHeadInfo)(r({},a,{title:n(e,a.title),initShowBackBtn:!1}))},a.createCardTitle=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,e.props.BillHeadInfo.createBillHeadInfo)(r({},a,{title:n(e,a.title)}))}},57:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.fillCurrentBill=void 0,a.initValidateButtons=function(e){var a,t=e.button.setButtonDisabled,n=(c(a={},r.BUTTON.Validate,!0),c(a,r.BUTTON.UnValidate,!0),a);t(n)},a.refreshcache=function(e,a,t,n,i){a?(0,o.addCacheData)(e,"pk_ct_price",n,t,r.AREA.card_head,i):(0,o.updateCacheData)(e,"pk_ct_price",n,t,r.AREA.card_head,i)},a.setDefaultValues=function(e){var a={pk_org:this.pk_org,pageId:r.PAGECODE.card};(0,n.ajax)({url:r.ACTION_URL.groupQuery,data:a,success:function(a){if(a.success){var t=a.data;e.form.setAllFormValue(c({},r.AREA.card_head,t.head[r.AREA.card_head]));var n=t.body[r.AREA.card_body];e.cardTable.setTableData(r.AREA.card_body,n)}}})};var r=t(8),n=t(0),o=t(7),i=t(168);function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}a.fillCurrentBill=i.fillCurrentBill},59:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.handleDynamicColumn=function(e,a,t,r){i.call(this,e,a,t,r)},a.doAddDynamicColumn=i,a.resetPriceItems=c;var r=t(8),n=t(0),o=t(89);function i(e,a,t,i){var l=this,d={pk_ct_price:a,pk_pricetemplet:t};(0,n.ajax)({url:r.ACTION_URL.dynamicColumn,data:d,success:function(a){if(a.success&&(o.hiddenPriceItems.call(l,e),a.data)){var r=a.data;c(e,r[t],i)}}})}function c(e,a,t){var r=e.meta.getMeta(),n=function(e){return e.forEach(function(e){e.itemtype="input",e.disabled=!1,e.visible=!0}),e}(a),o=r[t].items;o.findIndex(function(e,a){return"npriceitem1"==e.attrcode});!function(e,a){var t=new Map,r=a.map(function(e){return t.set(e.attrCode,e.label),e.attrCode});e.forEach(function(e){r.includes(e.attrcode)&&(e.disabled=!1,e.visible=!0,e.label=t.get(e.attrcode))})}(o,n),e.meta.setMeta(r)}},60:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.rowCopyPasteUtils=void 0;var r=t(0),n=!0,o=!1;function i(e,a,t,o,i,d){!function(e,a,t,n,o){var i=(0,r.deepClone)(t);if(i)if(i instanceof Array){for(var l=i.length,d=[],s=0;s<l;s++){var u=i[s].data;c(u,o),d.push(u)}e.cardTable.insertRowsAfterIndex(a,d,n)}else c(i,o),e.cardTable.insertRowsAfterIndex(a,i,n)}(e,a,this.state.copyRowDatas,t-1,d),this.setState({copyRowDatas:null}),l(e,o,i,n),e.cardTable.selectAllRows(a,!1),e.cardTable.setAllCheckboxAble(a,!0)}function c(e,a){a&&a instanceof Array&&(e instanceof Array?e.forEach(function(e){a.forEach(function(a){e.values[a]={value:null,display:null,scale:-1}})}):a.forEach(function(a){e.values[a]={value:null,display:null,scale:-1}}))}function l(e,a,t,r){a&&e.button.setButtonVisible(a,r),t&&e.button.setButtonVisible(t,!r)}var d={copyRow:function(e,a,t,r,n){return this.setState({copyRowDatas:t}),l(e,r,n,o),e.cardTable.setAllCheckboxAble(a,!1),t},copyRows:function(e,a,t,r){var n=e.cardTable.getCheckedRows(a);if(n&&n.length>0)return this.setState({copyRowDatas:n}),l(e,t,r,o),e.cardTable.setAllCheckboxAble(a,!1),n},pasteRowsToIndex:i,pasteRowsToTail:function(e,a,t,r,n){var o=e.cardTable.getNumberOfRows(a);i.call(this,e,a,o,t,r,n)},cancel:function(e,a,t,r){this.setState({copyRowDatas:null}),l(e,t,r,n),e.cardTable.selectAllRows(a,!1),e.cardTable.setAllCheckboxAble(a,!0)}};a.rowCopyPasteUtils=d},7:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.clearTransferCache=a.rewriteTransferSrcBids=a.updateCacheDataForList=a.deleteCacheDataForList=a.getNextId=a.getCurrentLastId=a.getDefData=a.setDefData=a.hasListCache=a.addCacheData=a.getCacheDataByPk=a.deleteCacheData=a.updateCacheData=a.changeUrlParam=void 0;var r=t(26);a.changeUrlParam=r.changeUrlParam,a.updateCacheData=r.updateCacheData,a.deleteCacheData=r.deleteCacheData,a.getCacheDataByPk=r.getCacheDataByPk,a.addCacheData=r.addCacheData,a.hasListCache=r.hasListCache,a.setDefData=r.setDefData,a.getDefData=r.getDefData,a.getCurrentLastId=r.getCurrentLastId,a.getNextId=r.getNextId,a.deleteCacheDataForList=r.deleteCacheDataForList,a.updateCacheDataForList=r.updateCacheDataForList,a.rewriteTransferSrcBids=r.rewriteTransferSrcBids,a.clearTransferCache=r.clearTransferCache},8:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={list_group1:"list_group1",Add_list:"Add_list",Delete_list:"Delete_list",Validate:"Validate",UnValidate:"UnValidate",list_print:"list_print",Refresh:"Refresh",Validate_inner:"Validate_inner",UnValidate_inner:"UnValidate_inner",Edit_inner:"Edit_inner",Delete_inner:"Delete_inner",History_inner:"History_inner",Copy_inner:"Copy_inner"},n={Add:"Add",card_group:"card_group",Edit:"Edit",Copy:"Copy",Validate:"Validate",UnValidate:"UnValidate",Print:"Print",Refresh:"Refresh",History:"History",Save:"Save",Cancel:"Cancel",AddLine:"AddLine",DeleteLine:"DeleteLine",CopyLine:"CopyLine",Delete:"Delete",ReorderLineNumber:"ReorderLineNumber",DeleteLineInner:"DeleteLineInner",InsertLineInner:"InsertLineInner",PasteToLast:"PasteToLast",PasteThere:"PasteThere",CancelPaste:"CancelPaste"},o=[n.Save,n.Cancel,n.DeleteLineInner,n.InsertLineInner,n.AddLine,n.DeleteLine,n.CopyLine,n.ReorderLineNumber,n.PasteToLast,n.PasteThere,n.CancelPaste],i=[n.Add,n.card_group,n.Delete,n.Edit,n.Copy,n.Validate,n.UnValidate,n.History,n.Print,n.Refresh],c=[r.list_group1,r.Add_list,r.Delete_list,r.Validate,r.UnValidate,r.list_print,r.Refresh];a.APPCODE=400400602,a.PAGECODE={list:"400400602_list",card:"400400602_card",history:"400400602_history"},a.AREA={searchArea:"searchArea",list_head:"list_head",list_inner:"list_inner",card_head:"card_head",card_body:"card_body",card_body_inner:"card_body_inner",history_head:"history_head",history_body:"history_body"},a.BUTTON=r,a.ACTION_URL={query:"/nccloud/ct/price/query.do",save:"/nccloud/ct/price/save.do",delete:"/nccloud/ct/price/delete.do",groupQuery:"/nccloud/ct/price/groupQuery.do",update:"/nccloud/ct/price/update.do",validate:"/nccloud/ct/price/validate.do",unvalidate:"/nccloud/ct/price/unvalidate.do",pageQuery:"/nccloud/ct/price/pageQuery.do",dynamicColumn:"/nccloud/ct/price/dynamicColumn.do",cardSetUp:"/nccloud/ct/price/cardSetUp.do",queryByPu:"/nccloud/ct/price/queryByPu.do",queryHistory:"/nccloud/ct/price/queryHistory.do",queryHistoryBody:"/nccloud/ct/price/queryHistoryBody.do",print:"/nccloud/ct/price/print.do",merge:"/nccloud/platform/templet/querypage.do",cardHeadAfter:"/nccloud/ct/price/cardHeadAfter.do",cardBodyAfter:"/nccloud/ct/price/cardBodyAfter.do",cardBefore:"/nccloud/ct/price/cardBefore.do",cardHeadBefore:"/nccloud/ct/price/cardHeadBefore.do"},a.UISTATUS={browse:"browse",edit:"edit"},a.BUTTON_BROWSE_LIST=c,a.BUTTON_CARD=n,a.BUTTON_CARD_EDIT=o,a.BUTTON_CARD_BROWSE=i,a.PriceCache={PriceCacheKey:"scm.ct.price.datasource",Searchval:"PriceList_serachVal"},a.FIELDS={pk_group:"pk_group",iversion:"iversion",pk_org:"pk_org",pk_puorg:"pk_puorg",bvalidateflag:"bvalidateflag",blatest:"blatest",cvendorid:"cvendorid",pk_marbasclass:"pk_marbasclass",pk_material:"pk_material","pk_material.materialspec":"pk_material.materialspec",pk_ct_price:"pk_ct_price",pk_ct_price_b:"pk_ct_price_b",ts:"ts",pk_oid:"pk_oid",pk_pricetemplet:"pk_pricetemplet",corigcurrencyid:"corigcurrencyid",orgregion:"orgregion",castunitid:"castunitid",crowno:"crowno",vcode:"vcode",totalprice:"totalprice",baseprice:"baseprice"},a.NPRICEITEMS=["npriceitem1","npriceitem2","npriceitem3","npriceitem4","npriceitem5","npriceitem6","npriceitem7","npriceitem8","npriceitem9","npriceitem10","npriceitem11","npriceitem12","npriceitem13","npriceitem14","npriceitem15","npriceitem16","npriceitem17","npriceitem18","npriceitem19","npriceitem20","npriceitem21","npriceitem22","npriceitem23","npriceitem24","npriceitem25","npriceitem26","npriceitem27","npriceitem28","npriceitem29","npriceitem30"],a.VOSTATUS={DELETE:"3"}},89:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.cvendorid_after=function(e,a,t,i,c){var l=(0,o.createHeadAfterEventData)(e,n.PAGECODE.card,n.AREA.card_head,n.AREA.card_body,a,t,i,{},[n.FIELDS.pk_org,n.FIELDS.cvendorid]);(0,r.ajax)({url:n.ACTION_URL.cardHeadAfter,data:l,success:function(a){a.success&&(console.log(a.data),(0,o.processBillCardHeadEditResult)(e,n.AREA.card_head,n.AREA.card_body,a.data),f(e))}})},a.material_after=function(e,a,t,i,c){var l=(0,o.createHeadAfterEventData)(e,n.PAGECODE.card,n.AREA.card_head,n.AREA.card_body,a,t,i,{},[n.FIELDS.pk_org,n.FIELDS.pk_marbasclass,n.FIELDS.pk_material]);(0,r.ajax)({url:n.ACTION_URL.cardHeadAfter,data:l,success:function(a){if(a.success){var t=a.data.billCard.head[n.AREA.card_head].rows[0].values.pk_marbasclass;t&&t.value||e.form.setFormItemsValue(n.AREA.card_head,{"pk_marbasclass.name":{value:null,display:null}}),(0,o.processBillCardHeadEditResult)(e,n.AREA.card_head,n.AREA.card_body,a.data)}}})},a.marbasclass_after=function(e,a,t,i,c){var l=(0,o.createHeadAfterEventData)(e,n.PAGECODE.card,n.AREA.card_head,n.AREA.card_body,a,t,i,{},[n.FIELDS.pk_org,n.FIELDS.pk_marbasclass,n.FIELDS.pk_material]);(0,r.ajax)({url:n.ACTION_URL.cardHeadAfter,data:l,success:function(a){var t;e.form.setFormItemsValue(n.AREA.card_head,(u(t={},n.FIELDS.pk_material,{display:null,value:null}),u(t,"pk_material.name",{display:null,value:null}),u(t,"pk_material.materialspec",{display:null,value:null}),u(t,"pk_material.materialtype",{display:null,value:null}),t));var r=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_marbasclass);r&&r.value&&(e.form.setFormItemsValue(n.AREA.card_head,u({},n.FIELDS.castunitid,{display:null,value:null})),e.form.setFormItemsDisabled(n.AREA.card_head,u({},n.FIELDS.castunitid,!0))),(0,o.processBillCardHeadEditResult)(e,n.AREA.card_head,n.AREA.card_body,a.data)}})},a.pricetemplet_after=function(e,a,t,r,o){if(o.value&&o.value!=r.value)(0,c.showWarningDialog)((0,s.getLangByResId)(this,"4004PRICE-000000"),(0,s.getLangByResId)(this,"4004PRICE-000001"),{beSureBtnClick:function(){var a=r.value,t=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_ct_price).value;p(e,t,a)},cancelBtnClick:function(){e.form.setFormItemsValue(n.AREA.card_head,u({},n.FIELDS.pk_pricetemplet,{display:o.display,value:o.value}))}});else if(o.value!=r.value){var i=r.value,l=e.form.getFormItemsValue(n.AREA.card_head,n.FIELDS.pk_ct_price).value;p(e,l,i)}},a.corigcurrencyid_after=function(e,a,t,i,c){var l=(0,o.createHeadAfterEventData)(e,n.PAGECODE.card,n.AREA.card_head,n.AREA.card_body,a,t,i,{},[n.FIELDS.pk_group,n.FIELDS.corigcurrencyid].concat(n.NPRICEITEMS));(0,r.ajax)({url:n.ACTION_URL.cardHeadAfter,data:l,success:function(a){a.success&&(0,o.processBillCardHeadEditResult)(e,n.AREA.card_head,n.AREA.card_body,a.data)}})},a.pk_org_after=function(e,a,t,r,o){var i=this;o.value?o.value!=r.value&&(0,c.showWarningDialog)((0,s.getLangByResId)(this,"4004PRICE-000000"),(0,s.getLangByResId)(this,"4004PRICE-000002"),{beSureBtnClick:function(){d.add.call(i,e,r.value),l.resetBodyButtons.call(i,e)},cancelBtnClick:function(){e.form.setFormItemsValue(n.AREA.card_head,u({},n.FIELDS.pk_org,{display:o.display,value:o.value}))}}):(d.add.call(this,e,r.value),l.resetBodyButtons.call(this,e))},a.clearPriceItems=f,a.hiddenPriceItems=function(e){e.cardTable.setColVisibleByKey(n.AREA.card_body,{hideKeys:n.NPRICEITEMS})};var r=t(0),n=t(8),o=t(43),i=t(59),c=t(3),l=t(47),d=t(90),s=t(2);function u(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function f(e){for(var a=e.cardTable.getNumberOfRows(n.AREA.card_body),t=function(a){n.NPRICEITEMS.forEach(function(t){e.cardTable.setValByKeyAndIndex(n.AREA.card_body,a,t,{value:null,display:null,scale:2})})},r=0;r<a;r++)t(r)}function p(e,a,t){f(e),(0,i.doAddDynamicColumn)(e,a,t,n.AREA.card_body)}},90:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.add=void 0;var r=t(8),n=t(45),o=t(0),i=(t(47),t(44));function c(e,a){var t={pk_org:a,pageId:r.PAGECODE.card};(0,o.ajax)({url:r.ACTION_URL.groupQuery,data:t,async:!1,success:function(a){if(a.success){var t=a.data;if(e.form.setAllFormValue((o={},i=r.AREA.card_head,c=t.head[r.AREA.card_head],i in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c,o)),e.form.getFormItemsValue(r.AREA.card_head,r.FIELDS.pk_org).value){var n=t.body[r.AREA.card_body];e.cardTable.setTableData(r.AREA.card_body,n,null,!0,!0),e.cardTable.setColVisibleByKey(r.AREA.card_body,{hideKeys:r.NPRICEITEMS})}}var o,i,c}})}a.add=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mainOrg,t=e.form,o=e.cardTable,l=(t.setFormStatus,t.EmptyAllFormValue),d=(o.setStatus,o.setTableData);l(r.AREA.card_head),d(r.AREA.card_body,{rows:[]}),c.call(this,e,a),i.RownoUtils.setRowNo(e,r.AREA.card_body),this.isAdd=!0,this.save_url=r.ACTION_URL.save,n.togglePageStatus.call(this,e,r.UISTATUS.edit)}}})});
//# sourceMappingURL=index.3923348e.js.map